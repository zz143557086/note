#### 什么是索引

```
索引的本质相当于目录
是帮助mysql高效获取数据的数据结构
在mysql中，数据最终存储到硬盘中  
访问磁盘相当于是IO操作,mysql有一个page的概念，一个page就是树中的一个节点，每次mysql都会取出一个page也就是一个节点的数据，而mysql默认一个page保存16k的数据
```

#### 二叉树

```
左子树的所有值都小于根节点
右子树的所有值都大于根节点
每个根节点最多分裂出两个子节点

缺点:极端情况查询最后一条数据会遍历整个表 相当于一个链表
```

#### 平衡二叉树

```
相对平衡，左右两个子树的深度差不能超过1
左右两个子树也必须是平衡二叉树
优点:可以避免二叉树的极端情况
缺点:一个节点只有两个叉，只能保存一条数据，单个节点保存数据少，就会造成节点增多,树的深度就会增多，查询次数就增多,造成资源浪费

```

#### B Tree

```
特点:m阶的B树一个节点最多数据拥有m-1个数据
每一个数据间隔有一个指针 从数据左侧开始数据右侧结束。左侧表示比数据小的，右侧表示比数据大的。数据数量超过m-1就将中间的数据向上提

举例:一个三层的树 每个数据大小是1k 一页是16k 三层保存的数据大小就是 16*16*16k
根节点保存16条数据 每个数据的指针指向一个节点有16条数据 3层就是4096条

优点:单个节点可以保存多个数据,page可以获取更多的数据，分叉增多数据层数会变小，数据查询次数会变少
缺点:数据从小到大到大依次分布在树的不同层级中的不稳定,相同层数保存的数据不然B+ Tree，进行范围查找时需要遍历整棵树
```

#### B+Tree

```
特点:叶子节点保存数据非叶子节点不保存，非叶子节点保存表示和指针。叶子节点通过指针相连的是双向箭头

举例如果一条数据是1k 一页是16k 一个数据标识是6b 非叶子节点保存16k/6b=2730个标识 每个标识有一个指针两层就是 2730*2730个表识 最后一层是数据有一个节点16条数据 一个标识指向一个节点三层数据就是 2730*2730*16 
```

#### Myisam索引的使用

```
三个文件
frm 保存表的定义信息
myi 保存索引信息
myd 保存数据信息
主键索引和非主键索引数据地址保存在叶子节点，通过地址在在数据表中找到数据
```

#### InnoDB

```
二个文件
frm 保存表的定义信息
ibd 保存索引信息和数据信息

主键索引数据直接放在叶子节点中 通过索引直接获得数据
非主键索引通过索引获取主键值在主键索引中获取到数据 
没有主键索引会自动创建主键索引
```

#### 回表

```
InnoDB中 非主键索引获取到主键值再通过主键索引获取到真正的数据的 其中通过主键值获取到主键索引就是回表
select 字段 就不会发生回表
select * 会发生回表
```

#### 1.为什么MySQL不用二叉树和平衡二叉树

因为二叉树有一个极端情况下数据全在左侧或者右侧查最后一条数据需要遍历整个表，平衡二叉树子树深度不超过1解决了这个问题但每一个节点只能存储一条数据浪费资源存储的数据少

#### 2.mysql为什么用b+ tree不要b tree

因为相同层数下b++ tree将数据放在叶子节点非叶子简单存储的是标识和指针存储的数据更多，并且在范围查找时只需要遍历叶子节点，b tree需要全表遍历，b++ tree 查询数据进行的io操作都一样查询数据更稳定

#### 3.为什么建议主键id是递增的

因为b++ tree插入数据是依次添加的，放一个page放慢后才会放入到下一个page保证page的充分利用

#### 4.为什么不建议使用uuid

因为uuid插入数据时随机的导致page得不到充分利用，增加分叉

#### 5.mysql中的聚集索引和稀疏索引如何理解

聚集索引 数据和索引存储在一起的就是聚集索引 反之就是稀疏索引 比如innoDB中的非主键索引 myisam都是稀疏索引

#### 6.like "aaa%"一定会用到索引吗

会用到遵循最左匹配原则，%aaa就用不到,最左方的%匹配不到

#### 7.为什么不建议些select *

避免回表，减少一次查询

#### 8.为什么innoDB引擎要求一定要建立主键索引

因为在主键索引中，直接存储的数据，非主键索引保存的是标识查到标识后回表到主键索引查询

#### 9.怎么理解最左匹配原则

从左到右依次匹配，从左的基础上依次查询到右的数据