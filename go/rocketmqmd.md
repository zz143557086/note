```
基于可靠消息的最终一致性
比如订单服务执行后将消息放入mq队列
库存服务和通知服务向mq队列获取消费消息 消息消费后会消失
特点虽然当前数据还没有数据一致，但是最终一定会一致

half消息解释 只发送给rocketmq中间件所以被称为half消息

1.MQ发送方 发送 half消息 给rocketmq
2.rocketmq 收到消息返回发送成功 给MQ发送方
3.MQ发送方执行本地事务
4.MQ发送方 commit/rollback 给rocketmq执行

5.如果MQ发送方长时间没有给rocketmq发送消息 rocket会向MQ发送方回查消息 为commit还是为rollback
6.MQ发送方收到回查请求会向查询本地事务状态
7.回查到本地事务状态向rocketmq返回状态

最后 消息为commit向mq订阅费投递消息
消息为rollback则丢弃消息

rocketmq重要机制消息回查 
优点 1.业务逻辑简单 2.高并发
```

### rocketmq的基本概念

```
Producer：消息的发送者 举例 发信者
Consumer 消息的接收机 举例 收信者
Broker 消息的暂存者 举例 邮局
NameServer：管理Broker 举例 各种邮局之间的管理机构
Topic：区分消息的种类，一个发送者可以发送消息给一个或者多个Topic;一个消息的接收者可以订阅一个或者多个Topic消息 
Message QUeue：相当于Topic的分区；用于并发发送和接收消息
```

#### 消息类型 按发送特点来分

```
1.同步发送  发送TPS：快  发送结果：有 可靠性：不丢失
2.异步发送	发送TPS：快  发送结果：有 可靠性：不丢失
3.单向发送	发送TPS：最快 发送结果：无 可靠性：可能丢失
```

#### 按功能特点来分

```
1.普通消息 不保证消息顺序
2.顺序消息 分区顺序消息 全家分区消息
3.延时消息 broker接收到了消息但过一段时间才会发送 场景：订单超时库存归还
4.事务消息
```

